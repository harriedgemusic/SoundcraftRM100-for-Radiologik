# PESA SWITCH FROM MSK RESERVED - script handlerscript pesaSwithFromMskRHandler    use scripting additions    # PESA command data string maker    on MakeString(theBytes)        set thestr to ""        repeat with i from 1 to length of theBytes            set thestr to thestr & (ASCII character (item i of theBytes))        end repeat        return thestr    end MakeString        on pesaSwFromMsk2:pLED0 pesaSwFromMsk2:pLED1 pesaSwFromMsk2:pLED2 pesaSwFromMsk2:cTEXT pesaSwFromMsk2:closedLED pesaSwFromMsk2:cautLED                set PESAledOFF to pLED0        set PESAledON1 to pLED1        set PESAledON2 to pLED2        set cautionText to cTEXT        set PortClosedLabel to closedLED        set PESAcaution to cautLED                set portPesa to serialport open "/dev/cu.serial1" bps rate 9600 data bits 8 parity 0 stop bits 1 handshake 0        if portPesa is -1 then            tell PESAledOFF to setHidden:1            tell PESAledON1 to setHidden:1            tell PESAledON2 to setHidden:1            tell cautionText to setHidden:1            tell PortClosedLabel to setHidden:1            tell PESAcaution to setHidden:0            log "PESA's serial port is unavailable (FROM MSK, RESERVED)"            else            set pesaCommand7FromMSK to MakeString({72, 48, 48, 50, 48, 48, 54, 48, 48, 54, 48, 48, 54, 48, 48, 54, 53, 51, 10})            log "generated 1st command"            set pesaCommand8FromMSK to MakeString({72, 48, 48, 54, 48, 48, 54, 48, 48, 54, 48, 48, 54, 48, 48, 54, 53, 55, 10})            log "generated 2st command"            delay 0.5                        # sending data string to port                        serialport write pesaCommand5FromMSK to portPesa            delay 0.5            serialport write pesaCommand6FromMSK to portPesa            delay 0.5                        # close PESA's port            serialport close my portPesa            tell PortClosedLabel to setHidden:1            tell PESAledON1 to setHidden:1            tell PESAledON2 to setHidden:1            tell PESAledOFF to setHidden:0        end if            end pesaSwFromMsk2:end script