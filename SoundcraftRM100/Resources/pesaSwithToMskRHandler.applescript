# PESA SWITCH TO MSK RESERVED - script handlerscript pesaSwithToMskRHandler    use scripting additions# PESA command data string makeron MakeString(theBytes)    set thestr to ""    repeat with i from 1 to length of theBytes        set thestr to thestr & (ASCII character (item i of theBytes))    end repeat    return thestrend MakeStringon pesaSwToMsk2:pLED0 pesaSwToMsk2:pLED1 pesaSwToMsk2:pLED2 pesaSwToMsk2:cTEXT pesaSwToMsk2:closedLED pesaSwToMsk2:cautLED        set PESAledOFF to pLED0    set PESAledON1 to pLED1    set PESAledON2 to pLED2    set cautionText to cTEXT    set PortClosedLabel to closedLED    set PESAcaution to cautLED        display dialog "MSK's fader is ON?" buttons {"YES", "NO"} default button 2        set x to button returned of result        # check PESA's state        if x is "YES" then                # open PESA's port        set portPesa to serialport open "/dev/cu.serial1" bps rate 9600 data bits 8 parity 0 stop bits 1 handshake 0                # check availability                if portPesa is -1 then            tell PESAledOFF to setHidden:1            tell PESAledON1 to setHidden:1            tell PESAledON2 to setHidden:1            tell cautionText to setHidden:1            tell PortClosedLabel to setHidden:1            tell PESAcaution to setHidden:0            log "PESA's serial port is unavailable"            else            set pesaCommand3ToMSK to MakeString({72, 48, 48, 56, 48, 48, 54, 48, 48, 54, 48, 48, 54, 48, 48, 54, 53, 57, 10})            log "generated 1st command"            set pesaCommand4ToMSK to MakeString({72, 48, 48, 50, 48, 48, 56, 48, 48, 56, 48, 48, 56, 48, 48, 56, 53, 59, 10})            log "generated 2st command"            delay 0.5                        # sending data string to port                        serialport write pesaCommand3ToMSK to portPesa            delay 0.5            serialport write pesaCommand4ToMSK to portPesa                        # close PESA's port            serialport close my portPesa            tell PortClosedLabel to setHidden:1            tell PESAledOFF to setHidden:1            tell PESAledON1 to setHidden:1            tell PESAledON2 to setHidden:0        end if    end if        # Nothing to do if MSK's fader is off        if x is "NO" then        log x    end if    end pesaSwToMsk2:end script